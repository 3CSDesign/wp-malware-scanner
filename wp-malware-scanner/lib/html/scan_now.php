<?php
function wp_malware_scanner_scan_nowpage($options)
{
?>
<style>
* {
  box-sizing: border-box;
}
.card-scan-now {
  /* Add shadows to create the "card" effect */
  border: 1px solid grey;
  border-radius: 5px;
  padding: 10px;
}
.buttonload {
  background-color: #04AA6D; /* Green background */
  border: none; /* Remove borders */
  color: white; /* White text */
  padding: 12px 24px; /* Some padding */
  font-size: 16px; /* Set a font-size */
}

/* Add a right margin to each icon */
.fa {
  margin-left: -12px;
  margin-right: 8px;
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<div class="row">
  <div class="column card-scan-now" style="background-color:#FFF;">
  <h2>Immediate Scan</h2>
  <p>Runs in Foreground. Best if your Cron Jobs Arent working correctly</p>
  <button type="button" id="rimsbutton" onclick="scan_now()" class="button button-primary" ><i id="rimsbutton_loader" style="margin-left: 5px;display: none;" class="fa fa-circle-o-notch fa-spin"></i>Run Immediate Scan</button>
  </div>
  <br>
  <div class="column card-scan-now" style="background-color:#FFF;">
  <h2>Sheduled Scan</h2>
  <p>Runs in Background</p>
  <form action="#" method="post">
  <input type="hidden" name="run_now" value="ok">
  <input type="submit" class="button button-primary" id="tsbutton" value="Trigger Sheduled Scan">
  </form>
  </div>
</div>
<br>
<script>
        function scan_now(){
            document.getElementById("rimsbutton").disabled = true;
            document.getElementById("tsbutton").disabled = true;
            document.getElementById("rimsbutton_loader").style.display = 'block';

            jQuery(document).ready(function($) {
            var data = {
                'action': 'Wp_malware_scanner_ScanFile_api',
                'data': "getState"
            };
                jQuery.post(ajaxurl, data, function(response) {
                    //alert('Got this from the server: ' + response);
                    console.log(response);
                    document.getElementById("rimsbutton").disabled = false;
                    document.getElementById("tsbutton").disabled = false;
                    document.getElementById("rimsbutton_loader").style.display = 'none';
                    if (response.error !=null) {
                        console.log(response.error);
                    }

                } );
            });            
        }
</script>
<?php
}
?>