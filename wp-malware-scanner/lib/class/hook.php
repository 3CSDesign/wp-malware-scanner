<?php
class ScannerHook {
    
    private $name;
    public function __construct($name) {
        $this->name =$name;
    }

    /**
     * 
     */
    public function createScheduledEvent($rate,$action)
    {
        add_action( "wp_malware_scanner_scheduled_$this->name", $action );
        if ( ! wp_next_scheduled( "wp_malware_scanner_scheduled_$this->name" ) ) {
            wp_schedule_event( time(), $rate, "wp_malware_scanner_scheduled_$this->name" );
        }

    }

    public function createSingleEvent($action)
    {
        add_action( "wp_malware_scanner_background_$this->name", $action );   
    }

    public function fireSingleEvent()
    {
        if ( ! wp_next_scheduled( "wp_malware_scanner_background_$this->name" ) ) {
            wp_schedule_single_event( time() , "wp_malware_scanner_background_$this->name"  );
        }       
    }

}
?>