<?php
/*
Plugin Name: WP Malware Scanner
Plugin URI: www.3cs.lk
Description: WP Malware Scanner
Version: 0.0.300
Author: Vimarsha Cooray
*/
if ( ! defined( 'ABSPATH' ) ) {
    exit; // Exit if accessed directly
}
require_once( WP_PLUGIN_DIR . '/wp-malware-scanner/lib/page_setting.php');
require_once( WP_PLUGIN_DIR . '/wp-malware-scanner/lib/update-checker.php');
/**
 * Plugin Intialisation
 */
add_action( 'plugins_loaded', 'wp_malware_scanner_init' );

/**
 * Init Function
 */
function wp_malware_scanner_init()
{
    add_action( 'admin_menu', 'register_wp_malware_scanner' );
    wp_malware_scanner_update();

    add_action( 'wp_malware_scanner_background_task', 'wp_malware_scanner_background_single_action' );

    // Hook into that action that'll fire our function
    if ( ! wp_next_scheduled( 'wp_malware_scanner_scheduled_event' ) ) {
        wp_schedule_event( time(), 'hourly', 'wp_malware_scanner_scheduled_event' );
    }
    // Hook into that action that'll fire our function
    add_action( 'wp_malware_scanner_scheduled_event', 'wp_malware_scanner_scheduled_event_action' );
}



function register_wp_malware_scanner(){
    add_menu_page( 'Scanner', 'Scanner', 'manage_options', 'wp_malware_scanner', 'wp_malware_scanner_home', 'dashicons-cloud-upload', 6 ); 
}
?>