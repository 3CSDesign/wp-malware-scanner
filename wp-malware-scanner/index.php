<?php
/*
Plugin Name: WP Malware Scanner
Plugin URI: www.3cs.lk
Description: Well, It's not ready yet
Version: 0.0.306
Author: Vimarsha Cooray
*/
if ( ! defined( 'ABSPATH' ) ) {
    exit; // Exit if accessed directly
}
require_once( WP_PLUGIN_DIR . '/wp-malware-scanner/lib/update-checker.php');
/**
 * Plugin Intialisation
 */
add_action( 'plugins_loaded', 'wp_malware_scanner_init' );

/**
 * Init Function
 */

 function wp_malware_scanner_init()
{
    add_action( 'admin_menu', 'register_wp_malware_scanner' );
    
    require_once 'lib/class/hook.php';
    require_once 'lib/class/action.php';
    require_once 'lib/class/setting.php';
    require_once 'lib/class/vulnerability.php';

    require_once 'lib/functions/autoload.php';
    include_once 'lib/utility.php';
    require_once ABSPATH . 'wp-content/plugins/wp-malware-scanner/scanner/scan.php';

    //store instances to call them later
    global $actionSet;
    global $hookSet;
    global $settingSet;
    global $vulnerabilitySet;

    //Load Handlers
    require_once 'lib/handlers/events.php';
    require_once 'lib/handlers/setting.php';
    require_once 'lib/handlers/action.php';

    $actionSet = new ActionsHandler();
    $hookSet = new EventsHandler();
    $settingSet = new SettingsHandler();
    $vulnerabilitySet = array();

    //Bootstrap
    require_once 'lib/bootstrap/events.php';
    require_once 'lib/bootstrap/action.php';
    require_once 'lib/bootstrap/settings.php';
    

    require_once( WP_PLUGIN_DIR . '/wp-malware-scanner/lib/page_setting.php');

    wp_malware_scanner_update();
}



function register_wp_malware_scanner(){
    add_menu_page( 'Scanner', 'Scanner', 'manage_options', 'wp_malware_scanner', 'wp_malware_scanner_home', 'dashicons-cloud-upload', 6 ); 
}
?>